RScripting 🏗️

RScripting is a developer-first framework for scripting Revit 2025 using native C# directly inside Visual Studio Code. It creates a live bridge between VS Code and Revit, enabling on-demand execution of scripts with full IntelliSense, Revit API access, and modern .NET 8.0 support — without building or compiling an add-in.

🔹 Key Features
- Live execution from VS Code — run C# scripts into Revit without compiling or reloading
- Native .NET 8.0 — modern language support without legacy frameworks
- Lightweight architecture — no persistent binaries, no AppDomains, no install steps for users
- Global Revit context — access Doc, UIDoc, Print(), and Transact() in every script
- Human-readable output — errors and messages stream to both a toast overlay and the Output panel
- Safe and scoped transactions — isolate element changes while keeping geometry construction lightweight
- Portable workspaces — scripts are just .cs files you can zip, version, or share

① Setup & Build
Clone the repo and initialize the system:
git clone https://github.com/YOUR_USERNAME/RScripting.git
cd RScripting
./build.sh


This will:
- 🔧 Compile RScript.Addin, rscript-bridge, and RScript.Combiner
- 📦 Package and install the VS Code extension
- 🗂 Deploy the Revit add-in and manifest to your AppData Addins folder
- 🚀 Prepare a clean, ready-to-use RScriptWorkspace (optional)
You only need to run build.sh again if you change system-level components (e.g., add-in or bridge code).
Scripts can be updated and executed freely afterward.


② Launch the Workspace
Open any folder in VS Code and run:
Command Palette → RScript: Initialize Workspace


This will scaffold:
- Scripts/ and Stubs/ directories
- A minimal .csproj preconfigured for Revit API usage
- IntelliSense stubs (Doc, UIDoc, Print, etc.)
- A sample script and transaction helpers
- Optional tasks.json and .vscode configs
You can create multiple independent workspaces — each one portable and self-contained.


③ Run Scripts
- Run the current script with Ctrl + Alt + R
- Or use Command Palette → RScript: Run Script
Output will appear in:
- Revit’s floating message bar (toast overlay)
- The VS Code Output panel under “RScripting”
- Local log files (for advanced debugging or history)
All script messages, exceptions, and diagnostics flow through Print(...) or error handlers — no guessing.


④ Developer Flow (No Build Required)
To develop or test from source:
- Press F5 in VS Code to launch the extension host
- Select any existing RScripting workspace
- Open Main.cs (or any script)
- Press Ctrl + Alt + R — script runs instantly inside Revit
There is no need to rebuild unless you're modifying core engine components or the VS Code extension.


🧩 Architecture Overview
├── RScript/               → Revit add-in and globals
├── RScript.Combiner/      → Code stitcher (workspace ➝ CombinedScript.cs)
├── rscript-bridge/        → Pipe-based transmitter from VS Code to Revit
├── rscript-extension/     → VS Code extension source
├── RScript.Addin.addin    → Manifest deployed to Revit roaming folder
├── RScriptWorkspace/      → Autogenerated script sandbox (optional)
├── bin/                   → Used during build to package executable tools



🛠 Optional: Extension Build
To repackage the VS Code extension manually:
cd rscript-extension
npm install
npm run package


This will generate a .vsix file for local use or marketplace publishing.

🧪 Developer vs User Workflow
Both users and developers use the same core toolchain — the only difference is where you launch VS Code and what you're editing.

✅ For Users (No Extension Debugging Required)
After cloning the repo:
cd RScripting
./build.sh


Then:
- Launch Revit, open any project, and run RScriptServer from the Add-In tab
- Open VS Code and select a folder to act as a workspace
- Run RScript: Initialize Workspace from the Command Palette
- Open Main.cs and press Ctrl + Alt + R to execute the script
You never need to touch the extension source folder or rebuild anything.


🧩 For Extension Developers (Working on the Extension Itself)
After running ./build.sh once to install all components:
cd rscript-extension
code .


Then:
- Press F5 to launch the Extension Development Host
- In the host window:
- Open or create a workspace folder
- Run RScript: Initialize Workspace
- Start RScriptServer inside Revit
- Press Ctrl + Alt + R to run the script
- Any edits to extension.ts or extension UI are now hot-reloadable during development
You can edit, test, and iterate without touching the build script again.


📄 License
Licensed under the MIT License.
Free for personal and commercial use.

👤 Author
Seyoum Hagos
Architect · Developer · Workflow Designer
Built in collaboration with Copilot
