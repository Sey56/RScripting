RScripting ğŸ—ï¸

RScripting is a developer-first framework for scripting Revit 2025 using native C# directly inside Visual Studio Code. It creates a live bridge between VS Code and Revit, enabling on-demand execution of scripts with full IntelliSense, Revit API access, and modern .NET 8.0 support â€” without building or compiling an add-in.

ğŸ”¹ Key Features
- Live execution from VS Code â€” run C# scripts into Revit without compiling or reloading
- Native .NET 8.0 â€” modern language support without legacy frameworks
- Lightweight architecture â€” no persistent binaries, no AppDomains, no install steps for users
- Global Revit context â€” access Doc, UIDoc, Print(), and Transact() in every script
- Human-readable output â€” errors and messages stream to both a toast overlay and the Output panel
- Safe and scoped transactions â€” isolate element changes while keeping geometry construction lightweight
- Portable workspaces â€” scripts are just .cs files you can zip, version, or share

â‘  Setup & Build
Clone the repo and initialize the system:
git clone https://github.com/YOUR_USERNAME/RScripting.git
cd RScripting
./build.sh


This will:
- ğŸ”§ Compile RScript.Addin, rscript-bridge, and RScript.Combiner
- ğŸ“¦ Package and install the VS Code extension
- ğŸ—‚ Deploy the Revit add-in and manifest to your AppData Addins folder
- ğŸš€ Prepare a clean, ready-to-use RScriptWorkspace (optional)
You only need to run build.sh again if you change system-level components (e.g., add-in or bridge code).
Scripts can be updated and executed freely afterward.


â‘¡ Launch the Workspace
Open any folder in VS Code and run:
Command Palette â†’ RScript: Initialize Workspace


This will scaffold:
- Scripts/ and Stubs/ directories
- A minimal .csproj preconfigured for Revit API usage
- IntelliSense stubs (Doc, UIDoc, Print, etc.)
- A sample script and transaction helpers
- Optional tasks.json and .vscode configs
You can create multiple independent workspaces â€” each one portable and self-contained.


â‘¢ Run Scripts
- Run the current script with Ctrl + Alt + R
- Or use Command Palette â†’ RScript: Run Script
Output will appear in:
- Revitâ€™s floating message bar (toast overlay)
- The VS Code Output panel under â€œRScriptingâ€
- Local log files (for advanced debugging or history)
All script messages, exceptions, and diagnostics flow through Print(...) or error handlers â€” no guessing.


â‘£ Developer Flow (No Build Required)
To develop or test from source:
- Press F5 in VS Code to launch the extension host
- Select any existing RScripting workspace
- Open Main.cs (or any script)
- Press Ctrl + Alt + R â€” script runs instantly inside Revit
There is no need to rebuild unless you're modifying core engine components or the VS Code extension.


ğŸ§© Architecture Overview
â”œâ”€â”€ RScript/               â†’ Revit add-in and globals
â”œâ”€â”€ RScript.Combiner/      â†’ Code stitcher (workspace â CombinedScript.cs)
â”œâ”€â”€ rscript-bridge/        â†’ Pipe-based transmitter from VS Code to Revit
â”œâ”€â”€ rscript-extension/     â†’ VS Code extension source
â”œâ”€â”€ RScript.Addin.addin    â†’ Manifest deployed to Revit roaming folder
â”œâ”€â”€ RScriptWorkspace/      â†’ Autogenerated script sandbox (optional)
â”œâ”€â”€ bin/                   â†’ Used during build to package executable tools



ğŸ›  Optional: Extension Build
To repackage the VS Code extension manually:
cd rscript-extension
npm install
npm run package


This will generate a .vsix file for local use or marketplace publishing.

ğŸ§ª Developer vs User Workflow
Both users and developers use the same core toolchain â€” the only difference is where you launch VS Code and what you're editing.

âœ… For Users (No Extension Debugging Required)
After cloning the repo:
cd RScripting
./build.sh


Then:
- Launch Revit, open any project, and run RScriptServer from the Add-In tab
- Open VS Code and select a folder to act as a workspace
- Run RScript: Initialize Workspace from the Command Palette
- Open Main.cs and press Ctrl + Alt + R to execute the script
You never need to touch the extension source folder or rebuild anything.


ğŸ§© For Extension Developers (Working on the Extension Itself)
After running ./build.sh once to install all components:
cd rscript-extension
code .


Then:
- Press F5 to launch the Extension Development Host
- In the host window:
- Open or create a workspace folder
- Run RScript: Initialize Workspace
- Start RScriptServer inside Revit
- Press Ctrl + Alt + R to run the script
- Any edits to extension.ts or extension UI are now hot-reloadable during development
You can edit, test, and iterate without touching the build script again.


ğŸ“„ License
Licensed under the MIT License.
Free for personal and commercial use.

ğŸ‘¤ Author
Seyoum Hagos
Architect Â· Developer Â· Workflow Designer
Built in collaboration with Copilot
